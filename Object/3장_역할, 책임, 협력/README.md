# Chapter 3 역할, 책임, 협력

## 2장 정리
추상 클래스, 인터페이스를 조합해 객체지향 프로그램을 구조화한다.  
다형성은 지연 바인딩 메커니즘으로 구현된다.  
상속은 코드를 재사용할 수 있는 가장 널리 알려진 방법이지만, 캡슐화 측면에서 합성이 더 좋은 방법이다.  
유연한 객체지향 프로그램일 수록 compile time 의존성과 run time 의존성이 다르다.  

## 객체지향의 핵심
협력, 책임, 역할  
객체지향의 본질은 자율적인 객체들의 공동체를 창조하는 것이다.  
객체란 상태와 행동을 함께 캡슐화하는 샐행 단위다.  

# 협력
애플리케이션의 기능을 구현하기 위해 수행하는 자율적인 객체간 상호작용을 의미한다.  
협력을 구성하는 객체끼리 요청과 응답의 흐름을 통해 애플리케이션의 기능이 구현된다.  

## 메시지 vs 메서드
메시지 전송(Message Sending)이란 협력안에서 객체끼리 통신할 수 있는 유일한 커뮤니케이션 수단이다.  
메서드는 메시지를 수신한 객체가 메시지를 처리할 방법으로 스스로 정의한 것이다.  
객체 외부는 메시지로 소통하고 내부 구현은 메서드로 캡슐화한다.  

## 협력을 고려한 설계순서
1. 객체가 참여하고 있는 협력(문맥) 파악  
2. 내부 구현을 캡슐화한 객체의 행동 결정  
3. 객체의 행동을 수행하는 데 필요한 객체의 상태 결정  

협력 -> 메시지 -> 메서드(객체 행동) -> 객체 상태 


# 책임
협력에 참여하기 위해 객체가 수행하는 행동이다.  
하는 것(doing)과 아는 것(knowing)으로 나뉜다.  
ex) 영화 예매 시스템에서 Movie 객체에게 할당된 책임  
- 하는 것: 영화 가격을 계산하기 위해 calculateMovieFee를 구현한다.  
- 아는 것: Screening 객체에게 calculateMovieFee 메시지를 수신하고 영화 가격을 계산하기 위해 fee와 discountPolicy를 속성으로 가진다.  

객체지향 설계에서 가장 중요한 것은 책임이다.  
객체에게 얼마나 적절한 책임을 할당하느냐에 전체적인 품질을 결정한다.  

## CRC 카드
Candidate(후보), Responsibility(책임), Collaborator(협력자)  
역할을 식별하고 책임을 할당하며 협력을 명시적으로 표현하는 설계 기법이다.  

## 책임 할당
자율적인 객체를 만들기 위해선 책임을 수행하는 데 필요한 정보를 가장 잘 알고 있는 전문가에게 그 책임을 할당해야 한다.  
정보 전문가에게 책임을 할당하는 것을 Information Expert Pattern(정보 전문가 패턴)이라고 한다.  
다만, 정보 전문가 패턴을 조금 포기하더라도 응집도와 결합도 관점에서 다른 객체에게 책임을 할당하는 것이 더 절절한 경우도 있다.  

## 책임 주도 설계
책임 주도 설계는 가장 먼저 책임을 정의하고 적절한 객체에게 책임을 할당하는 방식으로 설계하는 방법을 의미한다.  

## 협력, 책임을 고려한 설계 순서  
협력 -> 책임(아는 것, 하는 것) -> 메시지 -> 메시지를 처리할 객체에 책임 할당 -> 메서드(객체 행동) -> 객체 상태  

## 메시지가 객체를 결정해야 하는 이유
1. 객체가 최소한의 인터페이스를 가질 수 있게 된다.  
2. 객체는 충분히 추상적인 인터페이스를 가질 수 있게 된다.  

## 행동이 상태를 결정한다  
행동은 객체가 협력에 참여할 수 있는 유일한 방법이다.  
Data-Driven Design에서는 객체의 상태를 먼저 결정하고나서 행동을 결정한다.  
객체 내부 구현이 변경되면 이에 의존하는 외부 객체에게 변경의 영향이 전파된다.  

# 역할
특정 협력안에 수행하는 책임들의 집합이다.  
만약 협력에 적합한 책임을 수행하는 객체가 여러 종류라면 책임을 각각의 객체에 부여하는게 아니라 추상화된 역할에 책임을 부여한다.  
역할은 다양한 종류의 객체를 갈아끼울 수 있는 일종의 슬롯과 같다.  
역할을 이용하면 유연하고 재사용 가능한 협력을 얻을 수 있다.  
설계 초반에는 책임과 협력에 더 초점을 맞추고, 필요할 때 두 협력을 합치면서 두 객체를 포괄할 수 있는 역할을 고려하자.  
협력 문맥에 따라 역할에 할당된 객체는 바뀔 수 있다.  

## 추상화의 장점
1. 구체적인 부분을 배제하고 시스템을 상위 수준에서 더 간단하게 표현할 수 있다.  
2. 다양한 인스턴스를 수용가능하여 설계가 좀 더 유연해진다.  

추상화의 장점이 곧 역할의 장점과 같다.  
